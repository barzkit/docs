# BarzKit SDK

> BarzKit is a TypeScript SDK for creating self-custody smart account wallets for AI agents. It wraps Trust Wallet's Barz contracts (ERC-4337, Diamond Proxy EIP-2535) and provides gasless transactions, spending limits, contract whitelists, token whitelists, a kill switch, and DeFi actions (swap via Uniswap V3, lend via Aave V3). Install with `npm install @barzkit/sdk viem`. Requires a Pimlico API key (free at pimlico.io).

Key things to know:
- `createBarzAgent(config)` creates an agent wallet. Returns a `BarzAgent` object with `address`, `sendTransaction()`, `batchTransactions()`, `getBalance()`, `waitForTransaction()`, `swap()`, `lend()`, `getExplorerUrl()`, `getPermissions()`, `updatePermissions()`, `freeze()`, `unfreeze()`, `isActive()`.
- Gasless by default — paymaster covers gas, agent wallet needs no ETH.
- Permissions (`maxAmountPerTx`, `maxDailySpend`, `allowedTokens`, `allowedContracts`, `timeWindow`) are enforced client-side. Violations throw `PermissionError`.
- DeFi: `swap({ from, to, amount })` builds atomic approve+swap via Uniswap V3. `lend({ token, amount, protocol: 'aave' })` builds atomic approve+supply via Aave V3. Both validate `allowedTokens` permissions.
- Token utilities: `resolveToken(symbol, chain)`, `getTokenDecimals(symbol)`, `isNativeETH(token)`, `ETH_SENTINEL`.
- Calldata builders: `buildSwapTransactions()`, `buildLendTransactions()` return `TransactionRequest[]` without network calls.
- Uses `permissionless.js` from Pimlico under the hood. Import `toTrustSmartAccount` always requires `entryPoint: { address: entryPoint06Address, version: '0.6' }`.
- Chains: `'sepolia'`, `'base-sepolia'`, `'base'`.

## Docs

### Getting Started
- [Quickstart](https://github.com/barzkit/docs/blob/main/getting-started/quickstart.md): Create agent wallet and send first transaction in 5 minutes
- [Installation](https://github.com/barzkit/docs/blob/main/getting-started/installation.md): Prerequisites, npm install, Pimlico API key setup
- [Concepts](https://github.com/barzkit/docs/blob/main/getting-started/concepts.md): ERC-4337, Diamond Proxy, passkeys explained for non-blockchain developers

### Guides
- [Create an Agent Wallet](https://github.com/barzkit/docs/blob/main/guides/create-agent.md): `createBarzAgent()` full walkthrough, config options, error handling
- [Permissions](https://github.com/barzkit/docs/blob/main/guides/permissions.md): Spending limits, contract whitelists, token whitelists, time windows
- [Gasless Transactions](https://github.com/barzkit/docs/blob/main/guides/gasless.md): How paymaster sponsorship works, when to disable
- [Batch Transactions](https://github.com/barzkit/docs/blob/main/guides/batch-transactions.md): Atomic multi-call in a single UserOperation
- [DeFi Actions](https://github.com/barzkit/docs/blob/main/guides/defi-actions.md): Swap (Uniswap V3) and Lend (Aave V3) with code examples
- [Safety & Kill Switch](https://github.com/barzkit/docs/blob/main/guides/safety.md): Freeze/unfreeze, Guardian Facet, Phase 1 vs Phase 2
- [Multi-Chain](https://github.com/barzkit/docs/blob/main/guides/multi-chain.md): Sepolia, Base Sepolia, Base — explorer URLs, mainnet warning

### API Reference
- [AgentConfig](https://github.com/barzkit/docs/blob/main/api/agent-config.md): Configuration interface, SwapParams, LendParams
- [BarzAgent](https://github.com/barzkit/docs/blob/main/api/barz-agent.md): Full interface reference — all methods, params, return types
- [AgentPermissions](https://github.com/barzkit/docs/blob/main/api/permissions.md): Permission boundaries, supported units, enforcement model
- [Errors](https://github.com/barzkit/docs/blob/main/api/errors.md): Error classes, AA code mapping, error codes table
- [Chains](https://github.com/barzkit/docs/blob/main/api/chains.md): Supported chains, ChainConfig, token registry, DeFi protocol addresses

### Advanced
- [Diamond Proxy for Agents](https://github.com/barzkit/docs/blob/main/advanced/diamond-proxy.md): How EIP-2535 facets enable granular agent permissions
- [x402 Payments](https://github.com/barzkit/docs/blob/main/advanced/x402.md): Machine-to-machine payments (Phase 3)
- [ElizaOS Plugin](https://github.com/barzkit/docs/blob/main/advanced/elizaos-plugin.md): AI framework integration (Phase 3)

## Code

- [SDK source](https://github.com/barzkit/sdk/blob/main/src/index.ts): Public API exports
- [Account creation](https://github.com/barzkit/sdk/blob/main/src/core/account.ts): `createBarzAgent()`, `executeBatch()`, `swap()`, `lend()` implementation
- [Types](https://github.com/barzkit/sdk/blob/main/src/core/types.ts): `AgentConfig`, `BarzAgent`, `AgentPermissions`, `SwapParams`, `LendParams`, `TransactionRequest` interfaces
- [Client factory](https://github.com/barzkit/sdk/blob/main/src/core/client.ts): viem + Pimlico client setup
- [Permissions](https://github.com/barzkit/sdk/blob/main/src/permissions/permissions.ts): `PermissionManager` validation logic
- [Guardian](https://github.com/barzkit/sdk/blob/main/src/safety/guardian.ts): Freeze/unfreeze kill switch
- [Tokens](https://github.com/barzkit/sdk/blob/main/src/actions/tokens.ts): `resolveToken()`, `getTokenDecimals()`, `isNativeETH()`, `ETH_SENTINEL`
- [Swap](https://github.com/barzkit/sdk/blob/main/src/actions/swap.ts): `buildSwapTransactions()`, Uniswap V3 calldata builder
- [Lend](https://github.com/barzkit/sdk/blob/main/src/actions/lend.ts): `buildLendTransactions()`, Aave V3 calldata builder
- [Actions barrel](https://github.com/barzkit/sdk/blob/main/src/actions/index.ts): Re-exports for all action modules
- [Errors](https://github.com/barzkit/sdk/blob/main/src/utils/errors.ts): Error classes and AA error code mapping
- [Constants](https://github.com/barzkit/sdk/blob/main/src/utils/constants.ts): Token addresses, ERC20 ABI
- [Chain configs](https://github.com/barzkit/sdk/blob/main/src/chains/chains.ts): Sepolia, Base Sepolia, Base

## Examples

- [Simple agent](https://github.com/barzkit/examples/blob/main/simple-agent/index.ts): Minimal wallet creation and transaction
- [Batch transactions](https://github.com/barzkit/examples/blob/main/batch-transactions/index.ts): Atomic multi-call in a single UserOperation
- [DeFi agent](https://github.com/barzkit/examples/blob/main/defi-agent/index.ts): Swap tokens on Uniswap V3 and lend on Aave V3
- [Multi-chain](https://github.com/barzkit/examples/blob/main/multi-chain/index.ts): Deploy on multiple chains, getExplorerUrl demo
- [Gasless agent](https://github.com/barzkit/examples/blob/main/gasless-agent/index.ts): Permissions, freeze/unfreeze, gasless demo
- [Live test script](https://github.com/barzkit/sdk/blob/main/scripts/test-barz.ts): End-to-end Sepolia + Base Sepolia test

## Optional

- [Barz contracts](https://github.com/trustwallet/barz): Trust Wallet's smart contract source (Diamond Proxy, all facets)
- [Pimlico permissionless.js](https://docs.pimlico.io/permissionless): Underlying ERC-4337 library docs
- [Trust Wallet Barz guide](https://docs.pimlico.io/guides/how-to/accounts/use-trustwallet-account): Pimlico's integration guide for Barz accounts
- [ERC-4337 overview](https://docs.pimlico.io/conceptual/account-abstraction): Account Abstraction explained
